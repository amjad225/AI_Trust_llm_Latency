{
  "filename": "BOT-6505-step-tracking-complex.json",
  "name": "BOT-6505: Complex Step Tracking with Extended Multi-Bot Sequences",
  "description": "Tests step-based tracking in complex scenarios where bots send multiple consecutive messages across several conversation turns. Validates accurate step counting and objective satisfaction tracking.",
  "domain": "technical support",
  "compositeObjectives": [
    {
      "name": "Extended Multi-Response Conversation",
      "description": "Testing step tracking in conversations with complex bot response patterns",
      "persona": "Technical support customer with multiple issues",
      "userVariables": {
        "customerName": "Sarah Chen",
        "ticketId": "TECH-12345",
        "issueType": "multiple_problems"
      },
      "subObjectives": [
        {
          "description": "Bot acknowledges the initial request",
          "instructions": "Say 'I need technical support' and expect acknowledgment. Should be satisfied at step 2.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "current",
            "evaluationStrategy": "first_match",
            "recentTurnCount": 5
          }
        },
        {
          "description": "Bot provides multiple troubleshooting steps",
          "instructions": "Describe a technical problem and expect the bot to provide detailed steps. The bot may send multiple messages with different steps (steps 3, 4, 5). This tests step tracking across consecutive bot responses.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "any",
            "evaluationStrategy": "best_match",
            "recentTurnCount": 8
          }
        },
        {
          "description": "Bot asks for confirmation and offers alternatives",
          "instructions": "Say 'The steps didn't work' and expect the bot to ask for confirmation and offer alternative solutions. This tests step tracking when objectives span multiple bot messages.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "recent",
            "evaluationStrategy": "latest_match",
            "recentTurnCount": 6
          }
        },
        {
          "description": "Bot escalates to human support with explanation",
          "instructions": "Say 'I still need help' and expect escalation to human support with proper explanation. Tests step tracking in final conversation phases.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "current",
            "evaluationStrategy": "first_match",
            "recentTurnCount": 5
          }
        }
      ]
    },
    {
      "name": "Multi-Topic Information Request",
      "description": "Testing step tracking when bot provides information across multiple topics in consecutive messages",
      "persona": "Customer with multiple questions",
      "userVariables": {
        "customerName": "Mike Torres",
        "topics": "billing,features,support"
      },
      "subObjectives": [
        {
          "description": "Bot addresses billing question",
          "instructions": "Ask 'Can you help with billing and features?' The bot should address billing first. This tests step tracking when bot handles multiple topics in sequence.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "any",
            "evaluationStrategy": "first_match",
            "recentTurnCount": 10
          }
        },
        {
          "description": "Bot provides feature information",
          "instructions": "The bot should continue with feature information in subsequent messages. Tests step tracking across topic transitions.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "any",
            "evaluationStrategy": "first_match",
            "recentTurnCount": 10
          }
        },
        {
          "description": "Bot offers to connect to appropriate department",
          "instructions": "The bot should offer to connect you to the right department for further assistance. Tests step tracking in conclusion messages.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "recent",
            "evaluationStrategy": "latest_match",
            "recentTurnCount": 5
          }
        }
      ]
    }
  ]
}