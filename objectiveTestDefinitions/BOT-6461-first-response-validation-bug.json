{
  "filename": "BOT-6461-first-response-validation-bug.json",
  "name": "BOT-6461: First Bot Response Validation Bug",
  "description": "Test cases to reproduce and validate the fix for BOT-6461 where sub-objectives to verify bot greetings are not being validated properly on the first bot response. The greeting should be detected in Turn 1 but may not be validated correctly.",
  "domain": "customer service",
  "compositeObjectives": [
    {
      "name": "First Response Greeting - Current Scope",
      "description": "Test greeting validation with current scope - should detect greeting in first response",
      "persona": "New Customer Seeking Help",
      "userVariables": {
        "customerName": "TestUser1",
        "issueType": "general inquiry"
      },
      "subObjectives": [
        {
          "description": "Bot provides greeting and welcome message in first response",
          "instructions": "Start with 'Hello' and expect the bot to immediately greet you and offer assistance. This should be satisfied by the very first bot response.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "current",
            "evaluationStrategy": "first_match"
          }
        },
        {
          "description": "Bot asks how they can help in first response",
          "instructions": "The first bot response should include asking how they can help or what you need assistance with.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "current",
            "evaluationStrategy": "first_match"
          }
        }
      ]
    },
    {
      "name": "First Response Greeting - Recent Scope",
      "description": "Test greeting validation with recent scope - should detect greeting in first response",
      "persona": "Returning Customer",
      "userVariables": {
        "customerName": "TestUser2",
        "issueType": "follow-up question"
      },
      "subObjectives": [
        {
          "description": "Bot provides greeting and welcome message in first response",
          "instructions": "Start with 'Hi there' and expect the bot to immediately greet you. This objective should be satisfied by the very first bot response, not later turns.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "recent",
            "evaluationStrategy": "first_match",
            "recentTurnCount": 2
          }
        },
        {
          "description": "Bot shows professional tone in first response",
          "instructions": "The first bot response should demonstrate a professional and welcoming tone.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "recent",
            "evaluationStrategy": "best_match",
            "recentTurnCount": 3
          }
        }
      ]
    },
    {
      "name": "First Response Greeting - Any Scope",
      "description": "Test greeting validation with any scope - should definitely detect greeting in first response",
      "persona": "Curious Visitor",
      "userVariables": {
        "customerName": "TestUser3",
        "issueType": "information request"
      },
      "subObjectives": [
        {
          "description": "Bot provides greeting and welcome message",
          "instructions": "Start with 'Good day' and expect the bot to greet you. With 'any' scope, this should definitely be found in the first response.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "any",
            "evaluationStrategy": "first_match"
          }
        },
        {
          "description": "Bot demonstrates helpfulness in first interaction",
          "instructions": "The bot should show willingness to help from the very first response.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "any",
            "evaluationStrategy": "latest_match"
          }
        }
      ]
    },
    {
      "name": "Control Test - Multi-Turn Validation",
      "description": "Control test to ensure multi-turn objectives still work correctly",
      "persona": "Complex Query Customer",
      "userVariables": {
        "customerName": "ControlUser",
        "issueType": "complex request"
      },
      "subObjectives": [
        {
          "description": "Bot greets customer initially",
          "instructions": "Start with 'Hello' and expect immediate greeting from bot.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "any",
            "evaluationStrategy": "first_match"
          }
        },
        {
          "description": "Bot asks for more details in subsequent turn",
          "instructions": "After greeting, provide a vague request and expect the bot to ask for more specific details.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "current",
            "evaluationStrategy": "first_match"
          }
        },
        {
          "description": "Bot provides helpful response when given specifics",
          "instructions": "Provide specific details and expect a helpful, detailed response from the bot.",
          "isBlocking": false,
          "onFailure": null,
          "turnMatching": {
            "scope": "current",
            "evaluationStrategy": "best_match"
          }
        }
      ]
    }
  ]
} 